---
title: "浮動小数点数"
notes:
  - "structure"
  - "machine-epsilon"
  - "special-values"
---

浮動小数点数を確認します．

本セクションでは，注のない限り $2$ 進浮動小数点数を単に浮動小数点数と呼び，  
単精度を $32$ bit，倍精度を $64$ bit とします．  
また，符号つきのものを扱うものとし，規格として一般的な IEEE754 を採用します．

コンピュータで小数を扱う方法としては，

* 固定小数点数
* 浮動小数点数

の $2$ 通りがあります．

そもそもコンピュータの中では，

| 0 | 0 | 1 | 0 |
|:-:|:-:|:-:|:-:|

のように，$0$ と $1$ のどちらかを格納できる箱 **ビット** で $2$ 進数で数字を管理しています．

整数は特に問題なく，この場合は $2^{4} = 16$ 種類の数字，$0$ から $15$ の数字を扱うことができます．

しかし小数となると話は別です．

はじめ，**固定小数点数** というものが考えられました．  
その名の通り小数点を固定する，つまり各ビットを小数部分と整数部分に分けてしまえばいいということです．

| 0 | 0 | . | 1 | 0 |
|:-:|:-:|:-:|:-:|:-:|
| 整数用 | 整数用 | 小数点 | 小数用 | 小数用 |

（メモリの無駄なので小数点は存在しないけど存在するとみなします）

しかし，固定小数点数にはある問題があります．精度が怪しいのです．

簡単のため $10$ 進数で考えましょう．つまりビットのことを $0$ から $9$ まで入る箱だと思うことにします．  
この後のために少し使うビット数を増やしまして，例えば $\pi = 3.14159...$ は，

| 0 | 0 | 0 | 3 | . | 1 | 4 | 1 | 6 |
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|

のように近似的に表せます．

さて，ではこれを利用して半径 $r = 0.1$ の円の面積 $\pi r^{2}$ を表してみましょう！

| 0 | 0 | 0 | 0 | . | 0 | 3 | 1 | 4 |
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|

どうでしょうか．  
（わざとらしい半径ですが）少し面積を求めてみただけで元々 $5$ 桁の精度があったのに $3$ 桁になってしまいました．

このように固定小数点数にはこうした避けられない精度の問題があります．  
さらにいえば，アボガドロ定数 $N_{A} = 6.0221... × 10^{23}$ のような大きすぎたり小さすぎたりする値はメモリに収まらず扱うことができません．

これらへの対応策として **浮動小数点数** というものが考えられました．

浮動小数点数はざっくり今のように「値を表す部分（仮数部）」と「桁数を表す部分（指数部）」を分ける概念です．  
すなわち，例えばアボガドロ定数 $N_{A}$ を，

| 6 | . | 0 | 2 | 2 | 0 | 0 | 2 | 3 |
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
| 仮数部 | 小数点 | 仮数部 | 仮数部 | 仮数部 | 指数部 | 指数部 | 指数部 | 指数部 |

のように数字の部分と桁数の部分を分けて表します．  
こうすると固定小数点数よりかは精度を高く保ち，また値の範囲を広げることもできるようになります．

これでも実際には精度的な問題はついてきます．  
これ以上の小数をうまく扱う方式を考えるのも手ですが，まずは今ある道具（浮動小数点数）の使い方から改めていこう，というのも数値解析学の趣旨のひとつのようです．

浮動小数点数の具体的な構造や誤差の原因，その上手な使い方を本セクションでは纏めていきます．

### 余談

浮動小数点数は構造が複雑なので少し計算に時間がかかるというデメリットがあります．  
固定小数点数は単純なので計算はすぐに終わります．

しかし，特にコンピュータが大きく発達した近年では，速度よりも精度を優先して浮動小数点数を採用することが一般的です．  
