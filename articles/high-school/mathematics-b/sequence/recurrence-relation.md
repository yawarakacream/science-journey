---
title: "漸化式の戦略と基本パターン"
---

漸化式の頻出パターン集です。

漸化式の戦略は、**知っている形に持ち込む** に尽きます。  
特に、多くの場合 **等比数列** を目指すことが多いです。  
というか等差数列を目指すことは殆どありません。

＊書き途中です。。。

# 公式

教科書に載っているレベルの公式です。

## 等差数列 $a_{n + 1} = a_{n} + d$

ある項 $a_{n}$ にちょうど $d$ を足すと次の項 $a_{n + 1}$ になると言っています。  
これは公差 $d$ の等差数列です。

$$
a_{n} = a_{1} + (n - 1)d
$$

## 等比数列 $a_{n + 1} = ra_{n}$

ある項 $a_{n}$ にちょうど $r$ を掛けると次の項 $a_{n + 1}$ になると言っています。  
これは公比 $r$ の等比数列です。

$$
a_{n} = a_{1} r^{n - 1}
$$

## 階差数列 $a_{n + 1} = a_{n} + b_{n}$

ある項 $a_{n}$ にちょうど $b_{n}$ を足すと次の項 $a_{n + 1}$ になると言っています。  
これは $b_{n}$ を使った階差数列です。

$$
a_{n} = a_{1} + \sum_{k = 1}^{n - 1} b_{k} \quad (n \geqq 2)
$$

ただし $n = 1$ のとき $\sum$ が定義されないので、求まった一般項は $n \geqq 2$ のときにしか使えません。  
$n = 1$ で使えるかを確認し、使えなければ場合分けをして答えることになります。

# 基本

少し難しいですが、必ず押さえていたいパターンです。

## $a_{n + 1} = p a_{n} + q$

公式でないうちで最も有名な漸化式です！

ここで特性方程式なるものが突然登場し、混乱を招きます。  
そこで今回は特性方程式を導出しましょう。  
導出といっても考えてみれば当たり前のことなのですが、なぜか高校の先生は説明したがりません。不思議です。

戦略は **等比数列に持ち込む** です。

### 例

例として、漸化式

$$
a_{1} = 1,\ a_{n + 1} = 2 a_{n} + 2
$$

を解いてみます。

さて、等比数列と異なる点は $2$ です。  
これさえなければ等比数列の公式を使い一発です。

とはいえ勝手に消してしまうわけにはいきません。  
こういう場合、**左辺と右辺にうまく分配するとうまくいく** ことが知られています。  
今回は以下のように分けます。

$$
a_{n + 1} + 2 = 2 a_{n} + 4
$$

すると、

$$
(a_{n + 1} + 2) = 2 (a_{n} + 2)
$$

と変形でき、これは数列 $\{a_{n} + 2\}$ が等比 $2$ の等比数列であることを示しています。  
この数列の初項は $a_{1} + 2 = 3$ です。よって公式より、

$$
\begin{alignat*}{1}
             a_{n} + 2 &= 3 \cdot 2^{n - 1} \\
    \therefore ~ a_{n} &= 3 \cdot 2^{n - 1} - 2
\end{alignat*}
$$
$$
$$

というわけで、一般項 $a_{n}$ を求めることができました。

### 一般の場合

同様に $q$ をうまく分配することを考えます。

つまり適当な定数 $\alpha$ があって、

$$
(a_{n + 1} - \alpha) = p (a_{n} - \alpha)
$$

とできたなら数列 $\{a_{n} - \alpha\}$ が等比 $p$ の等比数列となり完璧です。  
$\alpha$ を求めるには $a_{n + 1} = p a_{n} + q$ と係数を比較すればいいでしょう。

$$
\begin{cases}
(a_{n + 1} - \alpha) = p (a_{n} - \alpha) \\
a_{n + 1} = p a_{n} + q
\end{cases}
$$

簡単に $\alpha$ が求まりそうですね！

解き方は様々あるでしょうが、今回は下の式の $a_{n + 1}$ を上の式に代入します。すると、

$$
\begin{alignat*}{1}
((p a_{n} + q) - \alpha) &= p (a_{n} - \alpha) \\
    p a_{n} + q - \alpha &= p a_{n} - p \alpha \\
              q - \alpha &= -p \alpha \\
                  \alpha &= p \alpha + q
\end{alignat*}
$$

どこかでみたような式がでてきました。  
そうです、これは $a_{n + 1} = p a_{n} + q$ の $a_{n + 1}$ と $a_{n}$ をともに $\alpha$ に置換した式です。

したがってうまく $q$ を分配できる $\alpha$ をみつけるには、$a_{n + 1}$ と $a_{n}$ をともに $\alpha$ に置換してしまえばいいということになります。

特性方程式のタネでした。
