---
title: "漸化式の戦略と基本パターン"
description: "漸化式の頻出パターン集です。漸化式は躓きやすい分野ですが、なぜか学校では説明してくれない特性方程式の導出からやさしく解説します。"
---

漸化式の頻出パターン集です。

漸化式の戦略は、**知っている形に持ち込む** に尽きます。  
特に、多くの場合 **等比数列を目指す** ことが多いです。  
というか等差数列を目指すことは殆どありません。

☆ の個数で難易度を示します。  
☆☆ までできれば、入試の $8$ 割は解けるでしょう。

＊書き途中です。。。が、高校の定期試験なら三項間漸化式を除けばこれで充分だとは思います。  


## ☆ 等差数列 $a_{n + 1} = a_{n} + d$

~~~spoiler:close

ある項 $a_{n}$ にちょうど $d$ を足すと次の項 $a_{n + 1}$ になると言っています。  
これは公差 $d$ の等差数列です。

$$
a_{n} = a_{1} + (n - 1)d
$$

~~~

## ☆ 等比数列 $a_{n + 1} = ra_{n}$

~~~spoiler:close

ある項 $a_{n}$ にちょうど $r$ を掛けると次の項 $a_{n + 1}$ になると言っています。  
これは公比 $r$ の等比数列です。

$$
a_{n} = a_{1} r^{n - 1}
$$

~~~

## ☆ 階差数列 $a_{n + 1} = a_{n} + b_{n}$

~~~spoiler:close

ある項 $a_{n}$ にちょうど $b_{n}$ を足すと次の項 $a_{n + 1}$ になると言っています。  
これは $b_{n}$ を使った階差数列です。

$$
a_{n} = a_{1} + \sum_{k = 1}^{n - 1} b_{k} \quad (n \geqq 2)
$$

ただし $n = 1$ のとき $\sum$ が定義されないので、求まった一般項は $n \geqq 2$ のときにしか使えません。  
$n = 1$ で使えるかを確認し、使えなければ場合分けをして答えることになります。

~~~

## ☆ $a_{n + 1} = p a_{n} + q$

~~~spoiler:close

公式でないうちで最も有名な二項間漸化式です！

ここで特性方程式なるものが突然登場し、混乱を招きます。  
そこで今回は特性方程式を導出しましょう。

導出といっても考えてみれば当たり前のことなのですが、なぜか高校の先生は説明したがりません。  
（実際のところはもう少し複雑な理論があるようですが、この場合においては以下の説明で充分だと思います。）

戦略は **$q$ を分配** して **等比数列に持ち込む** です。

### 例

例として、漸化式

$$
a_{1} = 1,\ a_{n + 1} = 2 a_{n} + 2
$$

を解いてみます。

さて、等比数列と異なる点は後ろの $+ 2$ です。  
これさえなければ等比数列の公式を使い一発です。

とはいえ勝手に消してしまうわけにはいきません。  
こういう場合、**左辺と右辺にうまく分配するとうまくいく** ことが知られています。  
今回は以下のように分けます。

$$
a_{n + 1} + 2 = 2 a_{n} + 4
$$

すると、

$$
(a_{n + 1} + 2) = 2 (a_{n} + 2)
$$

と変形でき、$\{a_{n} + 2\}$ をひとつの数列だと思うと、この数列は等比 $2$ の等比数列であることがわかります。

このように少し複雑な式を新しい数列だとみなすことは多々あります。  
というよりも、漸化式を解くというのは新しい数列を作り置き換えていく作業になります。

この数列の初項は $a_{1} + 2 = 3$ です。よって公式より、

$$
\begin{alignat*}{1}
             a_{n} + 2 &= 3 \cdot 2^{n - 1} \\
    \therefore ~ a_{n} &= 3 \cdot 2^{n - 1} - 2
\end{alignat*}
$$
$$
$$

というわけで、一般項 $a_{n}$ を求めることができました。

### 一般の場合

同様に $q$ をうまく分配することを考えます。

つまり適当な定数 $\alpha$ があって、

$$
(a_{n + 1} - \alpha) = p (a_{n} - \alpha)
$$

とできたなら数列 $\{a_{n} - \alpha\}$ が等比 $p$ の等比数列となり完璧です。  
$\alpha$ を求めるには $a_{n + 1} = p a_{n} + q$ と係数を比較すればいいでしょう。

$$
\begin{cases}
(a_{n + 1} - \alpha) = p (a_{n} - \alpha) \\
a_{n + 1} = p a_{n} + q
\end{cases}
$$

簡単に $\alpha$ が求まりそうですね！

解き方は様々あるでしょうが、今回は下の式の $a_{n + 1}$ を上の式に代入します。すると、

$$
\begin{alignat*}{1}
((p a_{n} + q) - \alpha) &= p (a_{n} - \alpha) \\
    p a_{n} + q - \alpha &= p a_{n} - p \alpha \\
              q - \alpha &= -p \alpha \\
                  \alpha &= p \alpha + q
\end{alignat*}
$$

どこかでみたような式がでてきました。  
これはちょうど $a_{n + 1} = p a_{n} + q$ の $a_{n + 1}$ と $a_{n}$ をともに $\alpha$ に置換した式です。  
このような置換をしてでてきた方程式を **特性方程式** といいます。

よって、うまく $q$ を分配できる $\alpha$ をみつけるには、$a_{n + 1}$ と $a_{n}$ をともに $\alpha$ に置換してしまえばいいのです。

特性方程式の仕組みでした。

個人的には特性方程式に頼らず、**分配** を意識して $(a_{n + 1} - \alpha) = p (a_{n} - \alpha)$ をつくり係数を比較すべきだと思います。  
理由としては特性方程式は $q$ が定数のときにしか使えず汎用的でないためです。  
使えない具体的な例は ☆☆ $a_{n + 1} = p a_{n} + f(n)$ にて扱います。

~~~

## ☆☆ $a_{n + 1} = p a_{n} + f(n)$

~~~spoiler:close

発展的な漸化式の代表例です。  
**特性方程式を使うと失敗する** ことで有名です。

$f(n + 1)$ は多項式とします。

$f(n)$ が定数のとき、すなわち「☆ $a_{n + 1} = p a_{n} + q$」のときと発想は変わりません。   
戦略は **$f(n)$ を分配** して **等比数列に持ち込む** です。

### 例

例として、漸化式

$$
a_{1} = 1,\ a_{n + 1} = 3 a_{n} + 2 n
$$

を解いてみます。

「☆ $a_{n + 1} = p a_{n} + q$」のときと同様 $2n$ が邪魔ですが勝手に消すわけにもいかないので、$2n$ を分配します。  
今回は以下のように分けます。

$$
\left( a_{n + 1} + (n + 1) + \frac{1}{2} \right) = 3 \left( a_{n} + n + \frac{1}{2} \right)
$$

元の式には定数項がありませんでしたが、分配するには定数項が必要です。  
一般に $m$ 次式を分配するには $m$ から $0$ までの次数すべての項を用意する必要があります。

さて、分配後のこの式は、数列 $\{a_{n} + n + \frac{1}{2}\}$ が等比 $3$ の等比数列であることを示しています。  
この数列の初項は $a_{1} + 1 + \frac{1}{2} = \frac{5}{2}$ です。よって公式より、

$$
\begin{alignat*}{1}
    a_{n} + n + \frac{1}{2} &= \frac{5}{2} \cdot 3^{n - 1} \\
    \therefore ~ a_{n} &= \frac{5}{2} \cdot 3^{n - 1} - n - \frac{1}{2} \\
\end{alignat*}
$$

というわけで、一般項 $a_{n}$ を求めることができました。

### 一般の場合

$f(n)$ を分配します。

前述の通り、$m$ 次式を分配するには $m$ から $0$ までの次数すべての項を用意する必要がある点に注意します。

### 失敗例（特性方程式）

さっきの例

$$
a_{1} = 1,\ a_{n + 1} = 3 a_{n} + 2 n
$$

に特性方程式を使ってみます。$a_{n + 1}$ と $a_{n}$ を $\alpha$ に置換すると、

$$
\alpha = 3 \alpha + 2 n
$$
$$
\therefore ~ \alpha = -n
$$
$$
\therefore ~ a_{n + 1} + n = 3 (a_{n} + n)
$$

さて、数列 $\{a_{n} + n\}$ は等比 $3$ の等比数列なので、、、といいたいところですが、  
よくみると左辺がおかしいですね。数列 $\{a_{n} + n\}$ の $n + 1$ 項は

$$
a_{n + 1} + n + 1
$$

のはずです。これでは等比数列とはいえません。

特性方程式が使えるのは $\alpha$ に $n$ が現れないときだけです。  
理由は $a_{n + 1} - \alpha$ と $a_{n} - \alpha$ が同じ数列になる必要があるためです。

特性方程式を丸暗記した人はよくこのパターンで解けずに終わります。  
仕組みを押さえておきましょう。

~~~

## ☆☆ $a_{n + 1} = a_{n}^{p}$

~~~spoiler:close

戦略は $\bm{\textcolor{blue}{\log}}$ を取って **等比数列** です。

実際に $\log$ を取ると、

$$
\begin{alignat*}{1}
    \log a_{n + 1} &= \log a_{n}^{p} \\
                  &= p \log a_{n}
\end{alignat*}
$$

となり、この式は数列 $\{\log a_{n}\}$ が等比 $p$ の等比数列であることを示しています。  
あとは公式に当てはめるだけです。

$\log$ の底は問題によってよさそうな数を選びます。  
初項にすると綺麗になることが多いです。

もちろん $\log$ を取れるのは $a_{n}$ がすべて正のときだけです。  
負になり得るは絶対値を取って後から符号を考えることになるでしょう。

### 例

次の漸化式を解いてみます。

$$
a_{0} = 2,\ a_{n + 1} = a_{n}^{3}
$$

$a_{n}$ は $2, 8, 512, ...$ と続き、すべて正の数です。  
明らかと言っていいでしょう。

正の数なので $\log$ を取ることができます。  
初項を底にすると綺麗になりやすいので $\log_{2}$ にします。

$$
\begin{alignat*}{1}
    \log_{2} a_{n + 1} &= \log_{2} a_{n}^{3} \\
                       &= 3 \log_{2} a_{n}
\end{alignat*}
$$

この式は数列 $\{\log_{2} a_{n}\}$ が等比 $3$ の等比数列であることを示しています。  
初項は $\log_{2} 2 = 1$ です。よって、

$$
\begin{alignat*}{1}
        \log_{2} a_{n} &= 1 \cdot 3^{n - 1} \\
                       &= 3^{n - 1} \\
    \therefore ~ a_{n} &= 2^{3^{n - 1}}
\end{alignat*}
$$

一般項 $a_{n}$ が求まりました。

~~~

## ☆☆ $a_{n + 1} = p a_{n} + q^{n}$

~~~spoiler:close

戦略は $\bm{\textcolor{blue}{q^{n + 1}}}$ **で割る** です。 

全体を $q^{n + 1}$ で割ると、

$$
\begin{alignat*}{1}
    \frac{a_{n + 1}}{q^{n + 1}} &= \frac{p a_{n} + q^{n}}{q^{n + 1}} \\
                                &= \frac{p}{q} \cdot \frac{a_{n}}{q^{n}} + \frac{1}{q}
\end{alignat*}
$$

となり、$\{\frac{a_{n}}{q^{n}}\}$ をひとつの数列とみなすと「☆ $a_{n + 1} = p a_{n} + q$」型に帰着されました。  
あとは普通に解くだけです。

もちろん $q^{n}$ で割っても問題ありません。そうすると $p,\ q$ の部分が整数になります。  
$q^{n + 1}$ だと大抵分数が出てきてしまいますが、添字が揃ってくれるので個人的には $q^{n + 1}$ 推しです。  
どちらで割るかは好みの問題でしょう。

### 例

漸化式

$$
a_{1} = 1,\ a_{n + 1} = 2 a_{n} + 3^{n}
$$

を解いてみます。

まずは全体を $3^{n + 1}$ で割ります。

$$
\begin{alignat*}{1}
    \frac{a_{n + 1}}{3^{n + 1}} &= \frac{2 a_{n} + 3^{n}}{3^{n + 1}} \\
                                &= \frac{2}{3} \cdot \frac{a_{n}}{3^{n}} + \frac{1}{3}
\end{alignat*}
$$

次に $\frac{1}{3}$ を分配します。

$$
\frac{a_{n + 1}}{3^{n + 1}} - 1 = \frac{2}{3} \left( \frac{a_{n}}{3^{n}} - 1 \right)
$$

この式は数列 $\{\frac{a_{n}}{3^{n}} - 1\}$ が等比 $\frac{2}{3}$ の等比数列であることを示しています。  
初項は $\frac{1}{3^{1}} - 1 = - \frac{2}{3}$ です。よって、

$$
\begin{alignat*}{1}
    \frac{a_{n}}{3^{n}} - 1 &= -\frac{2}{3} \cdot \left( \frac{2}{3} \right)^{n - 1} \\
                            &= - \left( \frac{2}{3} \right)^{n} \\
         \therefore ~ a_{n} &= 3^{n} - 2^{n}
\end{alignat*}
$$

一般項 $a_{n}$ が求まりました。

~~~

## ☆☆ $a_{n + 1} = \frac{p a_{n}}{q a_{n} + r}$

~~~spoiler:close

戦略は **逆数** です。

逆数をとると、

$$
\begin{alignat*}{1}
    \frac{1}{a_{n + 1}} &= \frac{q a_{n} + r}{p a_{n}} \\
                        &= \frac{r}{p} \cdot \frac{1}{a_{n}} + \frac{q}{p}
\end{alignat*}
$$

となり、$\{\frac{a_{n}}{q^{n}}\}$ をひとつの数列とみなすと「☆ $a_{n + 1} = p a_{n} + q$」型に帰着されました。  
あとは普通に解くだけです。

もちろん逆数を取るときには **(分母)** $\textcolor{blue}{\bm{\neq 0}}$ を確認しなければなりません。  
難しくないので適当に示してあげましょう。

### 例

漸化式

$$
a_{1} = 1,\ a_{n + 1} = \frac{a_{n}}{2 a_{n} + 4}
$$

を解いてみます。

まず逆数を取るために $a_{n} \neq 0$ を示します。

$n = 1$ のときは明らかです。  
$n \geqq 2$ のときは $a_{n} = 0$ と仮定すると、

$$
0 = \frac{a_{n - 1}}{2 a_{n - 1} + 4} \implies a_{n - 1} = 0
$$

であり、

$$
a_{n} = a_{n - 1} = a{n - 2} = \cdots = a_{2} = a_{1} = 0
$$

と続きますが、これは $a_{1} \neq 1$ に反します。  
よって背理法によりすべての $n$ に対し $a_{n} \neq 0$ であることがわかりました。

本題に入りましょう。逆数を取ると、

$$
\begin{alignat*}{1}
    \frac{1}{a_{n + 1}} &= \frac{2 a_{n} + 4}{a_{n}} \\
                        &= 4 \cdot \frac{1}{a_{n}} + 2
\end{alignat*}
$$

さらに $2$ を分配すると、

$$
\frac{1}{a_{n + 1}} + \frac{2}{3} = 4 \left( \frac{1}{a_{n}} + \frac{2}{3} \right)
$$

となり、この式は数列 $\{\frac{1}{a_{n}} + \frac{2}{3}\}$ が等比 $4$ の等比数列であることを示しています。  
初項は $\frac{1}{a_{1}} + \frac{2}{3} = \frac{5}{3}$ です。よって公式より、

$$
\begin{alignat*}{1}
    \frac{1}{a_{n}} + \frac{2}{3} &= \frac{5}{3} \cdot 4^{n - 1} \\
                  \frac{1}{a_{n}} &= \frac{5}{3} \cdot 4^{n - 1} - \frac{2}{3} \\
                                  &= \frac{5 \cdot 4^{n - 1} - 2}{3} \\
               \therefore ~ a_{n} &= \frac{3}{5 \cdot 4^{n - 1} - 2}
\end{alignat*}
$$

一般項 $a_{n}$ が求まりました。

~~~
