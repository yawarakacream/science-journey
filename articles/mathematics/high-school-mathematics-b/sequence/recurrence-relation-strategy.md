---
title: "漸化式の解き方"
description: "漸化式の戦略と基本パターン集です。漸化式は躓きやすい分野ですが、なぜか学校では説明してくれない特性方程式の導出からやさしく解説します。"
---

漸化式の戦略と基本パターン集です。

漸化式の戦略は、**知っている形に持ち込む** に尽きます。  
特に、多くの場合 **等比数列を目指す** ことが多いです。  
というか等差数列を目指すことは殆どありません。

☆ の個数で難易度を示します。  
☆☆ までできれば、漸化式を解くことは心配ないといえます。

## ☆ 等差数列 $a_{n + 1} = a_{n} + d$

~~~spoiler:close

ある項 $a_{n}$ にちょうど $d$ を足すと次の項 $a_{n + 1}$ になると言っています。  
これは公差 $d$ の等差数列です。

$$
a_{n} = a_{1} + (n - 1)d
$$

~~~

## ☆ 等比数列 $a_{n + 1} = ra_{n}$

~~~spoiler:close

ある項 $a_{n}$ にちょうど $r$ を掛けると次の項 $a_{n + 1}$ になると言っています。  
これは公比 $r$ の等比数列です。

$$
a_{n} = a_{1} r^{n - 1}
$$

~~~

## ☆ 階差数列 $a_{n + 1} = a_{n} + b_{n}$

~~~spoiler:close

ある項 $a_{n}$ にちょうど $b_{n}$ を足すと次の項 $a_{n + 1}$ になると言っています。  
これは $b_{n}$ を使った階差数列です。

$$
a_{n} = a_{1} + \sum_{k = 1}^{n - 1} b_{k} \quad (n \geqq 2)
$$

ただし $n = 1$ のとき $\sum$ が定義されないので、求まった一般項は $n \geqq 2$ のときにしか使えません。  
$n = 1$ で使えるかを確認し、使えなければ場合分けをして答えることになります。

~~~

## ☆ $a_{n + 1} = p a_{n} + q$

~~~spoiler:close

公式でないうちで最も有名な $2$ 項間漸化式です！

ここで特性方程式なるものが突然登場し、混乱を招きます。  
そこで今回は特性方程式を導出しましょう。

導出といっても考えてみれば当たり前のことなのですが、なぜか高校の先生は説明したがりません。  
（実際のところはもう少し複雑な理論があるようですが、この場合においては以下の説明で充分だと思います。）

戦略は **$q$ を分配** して **等比数列に持ち込む** です。

### 例

漸化式

$$
a_{1} = 1,\ a_{n + 1} = 2 a_{n} + 2
$$

を解いてみます。

さて、等比数列と異なる点は後ろの $+ 2$ です。  
これさえなければ等比数列の公式を使い一発です。

とはいえ勝手に消してしまうわけにはいきません。  
こういう場合、**左辺と右辺にうまく分配するとうまくいく** ことが知られています。  
今回は以下のように分けます。

$$
a_{n + 1} + 2 = 2 a_{n} + 4
$$

すると、

$$
(a_{n + 1} + 2) = 2 (a_{n} + 2)
$$

と変形でき、$\{a_{n} + 2\}$ をひとつの数列だと思うと、この数列は等比 $2$ の等比数列であることがわかります。

このように少し複雑な式を新しい数列だとみなすことは多々あります。  
というよりも、漸化式を解くというのは新しい数列を作り置き換えていく作業になります。

この数列の初項は $a_{1} + 2 = 3$ です。よって公式より、

$$
\begin{alignat*}{1}
             a_{n} + 2 &= 3 \cdot 2^{n - 1} \\
    \therefore ~ a_{n} &= 3 \cdot 2^{n - 1} - 2
\end{alignat*}
$$
$$
$$

というわけで、一般項 $a_{n}$ を求めることができました。

### 一般の場合

同様に $q$ をうまく分配することを考えます。

つまり適当な定数 $\alpha$ があって、

$$
(a_{n + 1} - \alpha) = p (a_{n} - \alpha)
$$

とできたなら数列 $\{a_{n} - \alpha\}$ が等比 $p$ の等比数列となり完璧です。  
$\alpha$ を求めるには $a_{n + 1} = p a_{n} + q$ と係数を比較すればいいでしょう。

$$
\begin{cases}
(a_{n + 1} - \alpha) = p (a_{n} - \alpha) \\
a_{n + 1} = p a_{n} + q
\end{cases}
$$

簡単に $\alpha$ が求まりそうですね！

解き方は様々あるでしょうが、今回は下の式の $a_{n + 1}$ を上の式に代入します。すると、

$$
\begin{alignat*}{1}
((p a_{n} + q) - \alpha) &= p (a_{n} - \alpha) \\
    p a_{n} + q - \alpha &= p a_{n} - p \alpha \\
              q - \alpha &= -p \alpha \\
                  \alpha &= p \alpha + q
\end{alignat*}
$$

どこかでみたような式がでてきました。  
これはちょうど $a_{n + 1} = p a_{n} + q$ の $a_{n + 1}$ と $a_{n}$ をともに $\alpha$ に置換した式です。  
このような置換をしてでてきた方程式を **特性方程式** といいます。

よって、うまく $q$ を分配できる $\alpha$ をみつけるには、$a_{n + 1}$ と $a_{n}$ をともに $\alpha$ に置換してしまえばいいのです。

特性方程式の仕組みでした。

個人的には特性方程式に頼らず、**分配** を意識して $(a_{n + 1} - \alpha) = p (a_{n} - \alpha)$ をつくり係数を比較すべきだと思います。  
理由としては特性方程式は $q$ が定数のときにしか使えず汎用的でないためです。  
使えない具体的な例は「☆☆ $a_{n + 1} = p a_{n} +$ (多項式)」にて扱います。

~~~

## ☆☆ $a_{n + 1} = p a_{n} + $ (多項式)

~~~spoiler:close

発展的な漸化式の代表例です。  
**特性方程式を使うと失敗する** ことで有名です。

多項式を $f(n)$ とします。

$f(n)$ が定数のとき、すなわち「☆ $a_{n + 1} = p a_{n} + q$」のときと発想は変わりません。   
戦略は **$f(n)$ を分配** して **等比数列に持ち込む** です。

### 例

例として、漸化式

$$
a_{1} = 1,\ a_{n + 1} = 3 a_{n} + 2 n
$$

を解いてみます。

「☆ $a_{n + 1} = p a_{n} + q$」のときと同様 $2n$ が邪魔ですが勝手に消すわけにもいかないので、$2n$ を分配します。  
今回は以下のように分けます。

$$
\left( a_{n + 1} + (n + 1) + \frac{1}{2} \right) = 3 \left( a_{n} + n + \frac{1}{2} \right)
$$

元の式には定数項がありませんでしたが、分配するには定数項が必要です。  
一般に $m$ 次式を分配するには $m$ から $0$ までの次数すべての項を用意する必要があります。

さて、分配後のこの式は、数列 $\{a_{n} + n + \frac{1}{2}\}$ が等比 $3$ の等比数列であることを示しています。  
この数列の初項は $a_{1} + 1 + \frac{1}{2} = \frac{5}{2}$ です。よって公式より、

$$
\begin{alignat*}{1}
    a_{n} + n + \frac{1}{2} &= \frac{5}{2} \cdot 3^{n - 1} \\
    \therefore ~ a_{n} &= \frac{5}{2} \cdot 3^{n - 1} - n - \frac{1}{2} \\
\end{alignat*}
$$

というわけで、一般項 $a_{n}$ を求めることができました。

### 一般の場合

$f(n)$ を分配します。

前述の通り、$m$ 次式を分配するには $m$ から $0$ までの次数すべての項を用意する必要がある点に注意します。

### 失敗例（特性方程式）

さっきの例

$$
a_{1} = 1,\ a_{n + 1} = 3 a_{n} + 2 n
$$

に特性方程式を使ってみます。$a_{n + 1}$ と $a_{n}$ を $\alpha$ に置換すると、

$$
\alpha = 3 \alpha + 2 n
$$
$$
\therefore ~ \alpha = -n
$$
$$
\therefore ~ a_{n + 1} + n = 3 (a_{n} + n)
$$

さて、数列 $\{a_{n} + n\}$ は等比 $3$ の等比数列なので、、、といいたいところですが、  
よくみると左辺がおかしいですね。数列 $\{a_{n} + n\}$ の $n + 1$ 項は

$$
a_{n + 1} + n + 1
$$

のはずです。これでは等比数列とはいえません。

特性方程式が使えるのは $\alpha$ に $n$ が現れないときだけです。  
理由は $a_{n + 1} - \alpha$ と $a_{n} - \alpha$ が同じ数列になる必要があるためです。

特性方程式を丸暗記した人はよくこのパターンで詰まります。    
仕組みを押さえておきましょう。

~~~

## ☆☆ $a_{n + 1} = a_{n}^{p}$

~~~spoiler:close

戦略は $\bm{\textcolor{blue}{\log}}$ を取って **等比数列** です。

実際に $\log$ を取ると、

$$
\begin{alignat*}{1}
    \log a_{n + 1} &= \log a_{n}^{p} \\
                  &= p \log a_{n}
\end{alignat*}
$$

となり、この式は数列 $\{\log a_{n}\}$ が等比 $p$ の等比数列であることを示しています。  
あとは公式に当てはめるだけです。

$\log$ の底は問題によってよさそうな数を選びます。  
初項にすると綺麗になることが多いです。

もちろん $\log$ を取れるのは $a_{n}$ がすべて正のときだけです。  
負になり得るときは絶対値を取って後から符号を考えることになるでしょう。

### 例

次の漸化式を解いてみます。

$$
a_{1} = 2,\ a_{n + 1} = a_{n}^{3}
$$

$a_{n}$ は $2, 8, 512, ...$ と続き、すべて正の数です。  
明らかと言っていいでしょう。

正の数なので $\log$ を取ることができます。  
初項を底にすると綺麗になりやすいので $\log_{2}$ にします。

$$
\begin{alignat*}{1}
    \log_{2} a_{n + 1} &= \log_{2} a_{n}^{3} \\
                       &= 3 \log_{2} a_{n}
\end{alignat*}
$$

この式は数列 $\{\log_{2} a_{n}\}$ が等比 $3$ の等比数列であることを示しています。  
初項は $\log_{2} 2 = 1$ です。よって、

$$
\begin{alignat*}{1}
        \log_{2} a_{n} &= 1 \cdot 3^{n - 1} \\
                       &= 3^{n - 1} \\
    \therefore ~ a_{n} &= 2^{3^{n - 1}}
\end{alignat*}
$$

一般項 $a_{n}$ が求まりました。

~~~

## ☆☆ $a_{n + 1} = p a_{n} + q^{n}$

~~~spoiler:close

戦略は $\bm{\textcolor{blue}{q^{n + 1}}}$ **で割る** です。 

全体を $q^{n + 1}$ で割ると、

$$
\begin{alignat*}{1}
    \frac{a_{n + 1}}{q^{n + 1}} &= \frac{p a_{n} + q^{n}}{q^{n + 1}} \\
                                &= \frac{p}{q} \cdot \frac{a_{n}}{q^{n}} + \frac{1}{q}
\end{alignat*}
$$

となり、$\{\frac{a_{n}}{q^{n}}\}$ をひとつの数列とみなすと「☆ $a_{n + 1} = p a_{n} + q$」型に帰着されました。  
あとは普通に解くだけです。

もちろん $q^{n}$ で割っても問題ありません。そうすると $p,\ q$ の部分が整数になります。  
$q^{n + 1}$ だと大抵分数が出てきてしまいますが、添字が揃ってくれるので個人的には $q^{n + 1}$ 推しです。  
どちらで割るかは好みの問題でしょう。

### 例

漸化式

$$
a_{1} = 1,\ a_{n + 1} = 2 a_{n} + 3^{n}
$$

を解いてみます。

まずは全体を $3^{n + 1}$ で割ります。

$$
\begin{alignat*}{1}
    \frac{a_{n + 1}}{3^{n + 1}} &= \frac{2 a_{n} + 3^{n}}{3^{n + 1}} \\
                                &= \frac{2}{3} \cdot \frac{a_{n}}{3^{n}} + \frac{1}{3}
\end{alignat*}
$$

次に $\frac{1}{3}$ を分配します。

$$
\frac{a_{n + 1}}{3^{n + 1}} - 1 = \frac{2}{3} \left( \frac{a_{n}}{3^{n}} - 1 \right)
$$

この式は数列 $\{\frac{a_{n}}{3^{n}} - 1\}$ が等比 $\frac{2}{3}$ の等比数列であることを示しています。  
初項は $\frac{1}{3^{1}} - 1 = - \frac{2}{3}$ です。よって、

$$
\begin{alignat*}{1}
    \frac{a_{n}}{3^{n}} - 1 &= -\frac{2}{3} \cdot \left( \frac{2}{3} \right)^{n - 1} \\
                            &= - \left( \frac{2}{3} \right)^{n} \\
         \therefore ~ a_{n} &= 3^{n} - 2^{n}
\end{alignat*}
$$

一般項 $a_{n}$ が求まりました。

~~~

## ☆☆ $a_{n + 1} = \frac{p a_{n}}{q a_{n} + r}$

~~~spoiler:close

$r = 0$ のときは $a_{n}$ が約分されて消えてしまうので，$r \neq 0$ とします．

戦略は **逆数** です。

逆数をとると、

$$
\begin{alignat*}{1}
    \frac{1}{a_{n + 1}} &= \frac{q a_{n} + r}{p a_{n}} \\
                        &= \frac{r}{p} \cdot \frac{1}{a_{n}} + \frac{q}{p}
\end{alignat*}
$$

となり、$\{\frac{a_{n}}{q^{n}}\}$ をひとつの数列とみなすと「☆ $a_{n + 1} = p a_{n} + q$」型に帰着されました。  
あとは普通に解くだけです。

もちろん逆数を取るときには **(分母)** $\textcolor{blue}{\bm{\neq 0}}$ を確認しなければなりません。  
難しくないので適当に示してあげましょう。

### 例

漸化式

$$
a_{1} = 1,\ a_{n + 1} = \frac{a_{n}}{2 a_{n} + 4}
$$

を解いてみます。

まず逆数を取るために $a_{n} \neq 0$ を示します。

$n = 1$ のときは明らかです。  
$n \geqq 2$ のときは $a_{n} = 0$ と仮定すると、

$$
0 = \frac{a_{n - 1}}{2 a_{n - 1} + 4}
$$
$$
\therefore ~ a_{n} = 0 \implies a_{n - 1} = 0
$$

であり、

$$
a_{n} = a_{n - 1} = a_{n - 2} = \cdots = a_{2} = a_{1} = 0
$$

となりますが、これは $a_{1} = 1$ に反するので、背理法により仮定は誤りで $b_{n} \neq 0$ です。  
よって数学的帰納法によりすべての自然数 $n$ に対し $a_{n} \neq 0$ であることがわかりました。

本題に入りましょう。逆数を取ると、

$$
\begin{alignat*}{1}
    \frac{1}{a_{n + 1}} &= \frac{2 a_{n} + 4}{a_{n}} \\
                        &= 4 \cdot \frac{1}{a_{n}} + 2
\end{alignat*}
$$

さらに $2$ を分配すると、

$$
\frac{1}{a_{n + 1}} + \frac{2}{3} = 4 \left( \frac{1}{a_{n}} + \frac{2}{3} \right)
$$

となり、この式は数列 $\{\frac{1}{a_{n}} + \frac{2}{3}\}$ が等比 $4$ の等比数列であることを示しています。  
初項は $\frac{1}{a_{1}} + \frac{2}{3} = \frac{5}{3}$ です。よって公式より、

$$
\begin{alignat*}{1}
    \frac{1}{a_{n}} + \frac{2}{3} &= \frac{5}{3} \cdot 4^{n - 1} \\
                  \frac{1}{a_{n}} &= \frac{5}{3} \cdot 4^{n - 1} - \frac{2}{3} \\
                                  &= \frac{5 \cdot 4^{n - 1} - 2}{3} \\
               \therefore ~ a_{n} &= \frac{3}{5 \cdot 4^{n - 1} - 2}
\end{alignat*}
$$

一般項 $a_{n}$ が求まりました。

~~~

## ☆☆ $a_{n + 2} = p a_{n + 1} + q a_{n}$

~~~spoiler:close

最も有名な $3$ 項間漸化式です！

戦略は **$2$ 項間漸化式に持ち込む** です。

「☆ $a_{n + 1} = p a_{n} + q$」と同様、特性方程式を用いた解法が一般的です。  
ここでは特性方程式を導出します。

発展問題として扱われ誘導がつくことも多いですが、自力で解けたい問題です。  
基本戦略さえ守ればそう難しいものでもありません。

### 例

```spoiler:close:嬉しいケース（特性方程式が重解を持たない）

漸化式

$$
a_{1} = a_{2} = 1,\ a_{n + 2} = 5 a_{n + 1} - 6 a_{n}
$$

を解いてみます。

$3$ 項間漸化式をそのまま解こうとするのは大変なので、$2$ 項間漸化式に持っていきたいです。

やはり **分配が鍵** で、今回は以下の $2$ 通りの分配方法が考えられます。

$$
a_{n + 2} - 2 a_{n + 1} = 3 \left( a_{n + 1} - 2 a_{n} \right)
$$
$$
a_{n + 2} - 3 a_{n + 1} = 2 \left( a_{n + 1} - 3 a_{n} \right)
$$

さて、

数列 $\{ a_{n + 1} - 2 a_{n} \}$ は等比 $3$ の等比数列で、初項は $a_{2} - 2 a_{1} = -1$  
数列 $\{ a_{n + 1} - 3 a_{n} \}$ は等比 $2$ の等比数列で、初項は $a_{2} - 3 a_{1} = -2$

であるので、

$$
a_{n + 1} - 2 a_{n} = -3^{n - 1}
$$
$$
\begin{alignat*}{1}
    a_{n + 1} - 3 a_{n} &= -2 \cdot 2^{n - 1} \\
                        &= -2^{n}
\end{alignat*}
$$

と表せます。

$2$ 項間漸化式に帰着できたので、もちろんどちらかの漸化式をこのまま解いても一般項は求まります。

しかしよくみると、上の式と下の式の差を取ると $a_{n + 1}$ が消去でき、一般項がすぐ求められそうです。すなわち、

$$
\begin{alignat*}{1}
    \left( (-2) - (-3) \right) a_{n} &= \left( -3^{n - 1} \right) - \left ( -2^{n} \right) \\
                               a_{n} &= 2^{n} - 3^{n - 1}
\end{alignat*}
$$

一般項 $a_{n}$ が求まりました。

```

```spoiler:close:嬉しくないケース（特性方程式が重解を持つ）

漸化式

$$
a_{1} = 1,\ a_{2} = -6,\ a_{n + 2} = 6 a_{n + 1} - 9 a_{n}
$$

を解いてみます。

やはり **分配が鍵** で、今回は以下の $1$ 通りの分配方法が考えられます。

$$
a_{n + 2} - 3 a_{n + 1} = 3 (a_{n + 1} - 3 a_{n})
$$

さて、数列 $\{a_{n + 1} - 3 a_{n}\}$ は等比 $3$ の等比数列で、初項は $a_{2} - 3 a_{1} = -9$ なので、

$$
\begin{alignat*}{1}
       a_{n + 1} - 3 a_{n} &= -9 \cdot 3^{n - 1} \\
                           &= - 3^{n + 1}
\end{alignat*}
$$

と表せます。

2 項間漸化式に帰着できたので、このまま解くことにより一般項が求まります。

式がひとつしかないので、$a_{n + 1}$ を消去することはできません。残念です。

「☆☆ $a_{n + 1} = p a_{n} + q^{n}$」と同様に解きます。  
$-3 a_{n}$ を右辺に移項して全体を $3^{n + 1}$ で割ると、

$$
\frac{a_{n + 1}}{3^{n + 1}} = \frac{a_{n}}{3^{n}} -1
$$

よって数列 $\{\frac{a_{n}}{3^{n}}\}$ 等差 $-1$ の等差数列であることがわかります。  
この数列の初項は $\frac{a_{1}}{3} = \frac{1}{3}$ なので、

$$
\begin{alignat*}{1}
    \frac{a_{n}}{3^{n}} &= \frac{1}{3} + (n - 1) \cdot (-1) \\
                        &= \frac{4}{3} - n \\
     \therefore ~ a_{n} &=4 \cdot 3^{n - 1} - 3^{n} n
\end{alignat*}
$$

一般項 $a_{n}$ が求まりました。

```

### 一般の場合

**分配の仕方** を **特性方程式** で求めます。

漸化式を、

$$
a_{n + 2} - \beta a_{n + 1} = \alpha (a_{n + 1} - \beta a_{n})
$$

と書けたなら、数列 $\{a_{n + 1} - \beta a_{n}\}$ が等比 $\alpha$ の等比数列になり、  
この一般項はすぐにわかるので $2$ 項間漸化式に帰着できます。

少し整理して，

$$
\begin{alignat*}{1}
    a_{n + 2} - \beta a_{n + 1} &= \alpha (a_{n + 1} - \beta a_{n}) \\
                      a_{n + 2} &= (\alpha + \beta) a_{n + 1} - \alpha \beta a_{n}
\end{alignat*}
$$

$\alpha,\ \beta$ を求めるには元の漸化式と係数を比較すればよいでしょう。

$$
\begin{alignat*}{1}
    a_{n + 2} &= (\alpha + \beta) a_{n + 1} - \alpha \beta a_{n} \\
    a_{n + 2} &= p a_{n + 1} + q a_{n}
\end{alignat*}
$$
$$
\therefore ~ \alpha + \beta = p,\ \alpha \beta = -q
$$

さて、$\alpha,\ \beta$ と $p,\ q$ の関係式がわかりました。  
ここからどのようにすれば $\alpha,\ \beta$ を求められるでしょうか？

よくみると、これは二次方程式の解と係数の関係の形です。  
すなわち $\alpha,\ \beta$ は、

$$
x^{2} - (\alpha + \beta) x + \alpha \beta = 0
$$

という二次方程式の解として求められます。  
そしてこの方程式は、

$$
x^{2} - p x - q = 0
$$

と書けるのでした。  
そしてさらに、ちょうど元の漸化式

$$
a_{n + 2} = p a_{n + 1} + q a_{n}
$$
$$
\iff a_{n + 2} - p a_{n + 1} - q a_{n} = 0
$$

の $a_{n + 2}$ を $x^{2}$ に、$a_{n + 1}$ を $x^{1}$ に、$a_{n}$ を $x^{0} = 1$ に置換した式といえます。

よって、上記のような置換をした結果の二次方程式を解けば分配の仕方が求まることになります。  
このような置換をした方程式を **特性方程式** といいます。

$2$ 項間漸化式に帰着したあとはふつうに解けばよいです。  
この式が **重解を持たない** ときは $a_{n + 1}$ をうまく消去できます。  
詳しくは例をみてください。

~~~

## ☆☆☆ $a_{n + 1} = \frac{p a_{n} + q}{r a_{n} + s}$

~~~spoiler:close

頻出パターンの中で **最難** の問題です。  

ふつう誘導がつきます。誘導がなく解き方を忘れてしまったら潔く捨てましょう。

戦略は **$q = 0$ のパターン「☆☆ $a_{n + 1} = \frac{p a_{n}}{q a_{n} + r}$」に持ち込む** です。  
これまでは何々を分配、としてきましたが、このパターンでは具体的にイメージしづらいです。

なお、今回紹介するパターン以外に $\alpha,\ \beta$ を特性方程式の解として

$$
b_{n} = \frac{a_{n} - \beta}{a_{n} - \alpha}
$$

とおいて等比数列に持ち込む方法もよく知られています。

### 例

例として、漸化式

$$
a_{1} = 2,\ a_{n + 1} = \frac{4 a_{n} + 2}{a_{n} + 5}
$$

を解いてみます。

分子の $2$ がなければ「☆☆ $a_{n + 1} = \frac{p a_{n}}{q a_{n} + r}$」形になってくれるので解けます。

これまでの経験から、

$$
a_{n + 1} - \alpha = \frac{k (a_{n} - \alpha)}{l(a_{n} - \alpha) + m}
$$

のようにして、**数列 $\{a_{n} - \alpha\}$ の議論に帰着** させるのがよさそうです。

さて、左辺はこれ以上変形のしようがありません。右辺をうまく変形します。  
具体的には、左辺に勝手に $- \alpha$ を入れるわけにはいかないので、

$$
a_{n + 1} - \alpha = \frac{4 a_{n} + 2}{a_{n} + 5} - \alpha
$$

とし、この右辺を「$\frac{p a_{n}}{q a_{n} + r}$」形に変えていきます。

分母を決めないことには分子も扱えないので、まず分母から、

$$
\begin{alignat*}{1}
    a_{n + 1} - \alpha &= \frac{4 a_{n} + 2}{a_{n} + 5} - \alpha \\
                       &= \frac{4 a_{n} + 2}{(a_{n} \textcolor{red}{- \alpha}) + (\textcolor{red}{\alpha} + 5)} - \alpha
\end{alignat*}
$$

とすると $a_{n} - \alpha$ がでてきてくれました。次に分子を、

$$
\begin{alignat*}{1}
    a_{n + 1} - \alpha &= \frac{4 a_{n} + 2}{(a_{n} - \alpha) + (\alpha + 5)} - \alpha \\
                       &= \frac{(4 a_{n} + 2) - \alpha ((a_{n} - \alpha) + (\alpha + 5))}{(a_{n} - \alpha) + (\alpha + 5)} \\
                       &= \frac{(4 (a_{n} \textcolor{red}{- \alpha + \alpha}) + 2) - \alpha ((a_{n} - \alpha) + (\alpha + 5))}{(a_{n} - \alpha) + (\alpha + 5)} \\
                       &= \frac{4 (a_{n} - \alpha) + (4 \alpha + 2) - \alpha (a_{n} - \alpha) - \alpha (\alpha + 5)}{(a_{n} - \alpha) + (\alpha + 5)} \\
                       &= \frac{(4 - \alpha) (a_{n} - \alpha) + ((4 \alpha + 2) - \alpha (\alpha + 5))}{(a_{n} - \alpha) + (\alpha + 5)} \\
\end{alignat*}
$$

とすると $a_{n} - \alpha$ がでてきてくれました。

さて、私たちの目標は分子の $2$、つまり分子の定数部をうまく辻褄を合わせて消すことでした。  
この式の分子の定数部は $(4 \alpha + 2) - \alpha (\alpha + 5)$ です。すなわち、

$$
(4 \alpha + 2) - \alpha (\alpha + 5) = 0
$$

という方程式により $\alpha$ を定めれば、定数が消えてくれます。

これを解くと、

$$
\alpha = -2,\ 1
$$

となります。

どちらを採用してもいいですが、今回は $\alpha = 1$ を採用してみると、

$$
\begin{alignat*}{1}
    a_{n + 1} - \alpha &= \frac{(4 - \alpha) (a_{n} - \alpha) + ((4 \alpha + 2) - \alpha (\alpha + 5))}{(a_{n} - \alpha) + (\alpha + 5)} \\
    a_{n + 1} - 1 &= \frac{3 (a_{n} - 1)}{(a_{n} - 1) + 6} \\
\end{alignat*}
$$

となります。これは数列 $\{a_{n} - 1\}$ が「☆☆ $a_{n + 1} = \frac{p a_{n}}{q a_{n} + r}$」形であることを示しています。

**帰着手順はここまで** です。長くなりましたが一応最後まで解いておきます。

$b_{n} = a_{n} - 1$ とおくと、

$$
b_{1} = 1,\ b_{n + 1} = \frac{3 b_{n}}{b_{n} + 6}
$$

逆数をとるために $b_{n} \neq 0$ を示します。

$n = 1$ のときは明らかです。  
$n \geq 2$ のときは $b_{n} = 0$ と仮定すると $b_{n - 1} = 0$ であり、同様にして $b_{n} = 0$ ならば $b_{n} = b_{n - 1} = ... = b_{1} = 0$ となりますが、これは $a_{1} = 1$ に反するので、背理法により仮定は誤りで $b_{n} \neq 0$ です。

よって数学的帰納法によりすべての自然数 $n$ に対し $b_{n} \neq 0$ であることがわかりました。

逆数をとると、

$$
\begin{alignat*}{1}
    \frac{1}{b_{n + 1}} &= \frac{b_{n} + 6}{3 b_{n}} \\
                        &= 2 \cdot \frac{1}{b_{n}} + \frac{1}{3}
\end{alignat*}
$$

さらに $\frac{1}{3}$ を分配すると、

$$
\frac{1}{b_{n + 1}} + \frac{1}{3} = 2 \left( \frac{1}{b_{n}} + \frac{1}{3} \right)
$$

となり、数列 $\{\frac{1}{b_{n}} + \frac{1}{3}\}$ は等比 $2$ の等比数列です。  
初項は $\frac{1}{b_{1}} + \frac{1}{3} = \frac{4}{3}$ です。よって公式より、

$$
\begin{alignat*}{1}
    \frac{1}{b_{n}} + \frac{1}{3} &= \frac{4}{3} \cdot 2^{n - 1} \\
    \frac{1}{b_{n}}               &= \frac{2^{n + 1} - 1}{3} \\
    b_{n}                         &= \frac{3}{2^{n + 1} - 1} \\
    a_{n} - 1                     &= \frac{3}{2^{n + 1} - 1} \\
    a_{n}                         &= \frac{3}{2^{n + 1} - 1} + 1 \\
                                  &= \frac{2^{n + 1} + 2}{2^{n + 1} - 1}
\end{alignat*}
$$

一般項 $a_{n}$ が求まりました。

### 一般の場合

例で出てきた方程式

$$
(4 \alpha + 2) - \alpha (\alpha + 5) = 0
$$

はよくみると、

$$
a_{n + 1} = \frac{4 a_{n} + 2}{a_{n} + 5}
$$

の $a_{n + 1},\ a_{n}$ を $\alpha$ に置き換えた方程式といえることがわかります。

例によってこうした方程式を **特性方程式** と呼び、これを用いると

$\quad$ $\displaystyle a_{n + 1} - 1 = \frac{4 a_{n} + 2}{a_{n} + 5} - 1 ~$ や $\displaystyle ~ a_{n + 1} + 2 = \frac{4 a_{n} + 2}{a_{n} + 5} + 2$

とすると面倒な計算をしなくても辻妻が合い分子の定数部が消えることがすぐにわかります。

~~~
